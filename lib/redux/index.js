"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _react=_interopRequireDefault(require("react"));var _reactRedux=require("react-redux");var _reactRouter=require("react-router");var _server=_interopRequireDefault(require("react-dom/server"));var _boom=_interopRequireDefault(require("@hapi/boom"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}const ROUTER_MATCH='Renderer encountered an error raised by ReactRouter.match()';const REACT_RENDER='Renderer caught an implementation error in ReactDOMServer.renderToString()';const badImplementation=message=>_boom.default.badImplementation(message);const notFound=location=>_boom.default.notFound(`ReactRouter.match() cannot find ${location}`);const renderToString=(store,props)=>_server.default.renderToString(_react.default.createElement(_reactRedux.Provider,{store:store},_react.default.createElement(_reactRouter.RouterContext,props)));var _default=(store,routes,location)=>new Promise((resolve,reject)=>{(0,_reactRouter.match)({routes,location},(e,redirect,props)=>{let b;if((b=!!e)||!redirect&&!props){return reject(b?badImplementation(ROUTER_MATCH):notFound(location));}if(redirect)return resolve({redirect});const{getState}=store;try{const rendered=renderToString(store,props);const state=getState();resolve({rendered,state});}catch(e){reject(badImplementation(REACT_RENDER));void e;}});});exports.default=_default;